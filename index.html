<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <marimo-mode data-mode='read' hidden></marimo-mode>
    <marimo-version data-version='0.11.18' hidden></marimo-version>
    <marimo-user-config data-config='{"completion": {"activate_on_typing": true, "copilot": false}, "display": {"default_width": "full", "theme": "dark", "code_editor_font_size": 14, "dataframes": "plain", "cell_output": "below"}, "formatting": {"line_length": 79}, "keymap": {"preset": "default", "overrides": {}}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "on_cell_change": "autorun", "watcher_on_save": "lazy", "output_max_bytes": 8000000, "std_stream_max_bytes": 1000000, "pythonpath": []}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "package_management": {"manager": "pip"}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}}' data-overrides='{}' hidden></marimo-user-config>
    <marimo-app-config data-config='{"width": "full"}' hidden></marimo-app-config>
    <marimo-server-token data-token='123' hidden></marimo-server-token>
    <title>DailyCompIRCalc</title>
    <script type="module" crossorigin src="./assets/index-DlgzP3k1.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-CpHxmtkS.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="" data-show-code="false">import%20marimo%0A%0A__generated_with%20%3D%20%220.11.18%22%0Aapp%20%3D%20marimo.App(width%3D%22full%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20from%20fredapi%20import%20Fred%0A%20%20%20%20import%20altair%20as%20alt%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20datetime%20as%20dt%0A%20%20%20%20import%20pandas_market_calendars%20as%20mcal%0A%20%20%20%20import%20pandas.tseries.holiday%20as%20hol%0A%20%20%20%20from%20pandas.tseries.offsets%20import%20CustomBusinessDay%0A%20%20%20%20from%20urllib.request%20import%20urlopen%20%0A%20%20%20%20import%20json%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20CustomBusinessDay%2C%0A%20%20%20%20%20%20%20%20Fred%2C%0A%20%20%20%20%20%20%20%20alt%2C%0A%20%20%20%20%20%20%20%20dt%2C%0A%20%20%20%20%20%20%20%20hol%2C%0A%20%20%20%20%20%20%20%20json%2C%0A%20%20%20%20%20%20%20%20mcal%2C%0A%20%20%20%20%20%20%20%20mo%2C%0A%20%20%20%20%20%20%20%20np%2C%0A%20%20%20%20%20%20%20%20pd%2C%0A%20%20%20%20%20%20%20%20urlopen%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(f%22%23%20%7Bmo.icon('solar%3Abasketball-bold')%7D%20Compound%20daily%20interest%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Fred%2C%20pd)%3A%0A%20%20%20%20%23import%20data%0A%0A%20%20%20%20%23SOFR%0A%20%20%20%20fred%20%3D%20Fred(api_key%3D'3ea3cdaca8c750bf03bd23cddc2f1089')%0A%20%20%20%20series%20%3D%20'SOFR'%0A%20%20%20%20sofr_data%20%3D%20pd.DataFrame(fred.get_series(series))%0A%20%20%20%20sofr_data.columns%3D%5Bseries%5D%0A%20%20%20%20sofr_data%20%3D%20sofr_data.reset_index()%0A%20%20%20%20sofr_data.rename(columns%3D%7B'SOFR'%3A%20'RATE'%7D%2C%20inplace%3DTrue)%0A%0A%20%20%20%20%23SARON%0A%20%20%20%20saron_data%20%3D%20pd.read_csv('hsrron.csv'%2C%20sep%20%3D'%3B'%2C%20skiprows%20%3D%203)%0A%20%20%20%20saron_data%20%3D%20saron_data%5B%5B'Date'%2C%20'Close'%5D%5D%0A%20%20%20%20saron_data%5B'Date'%5D%20%3D%20pd.to_datetime(saron_data%5B'Date'%5D%2C%20format%3D'%25d.%25m.%25Y')%0A%20%20%20%20saron_data%5B'Close'%5D%20%3D%20saron_data%5B'Close'%5D.astype(float)%0A%20%20%20%20saron_data.sort_values(by%3D%5B'Date'%5D%2C%20inplace%3DTrue)%0A%20%20%20%20saron_data.rename(columns%3D%7B'Date'%3A'index'%2C%20'Close'%3A%20'RATE'%7D%2C%20inplace%3DTrue)%0A%20%20%20%20return%20fred%2C%20saron_data%2C%20series%2C%20sofr_data%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20_options%20%3D%20%5B%22SOFR%22%2C%20%22SARON%22%5D%0A%20%20%20%20dropdown%20%3D%20mo.ui.dropdown(options%3D_options)%0A%20%20%20%20dropdown%0A%20%20%20%20return%20(dropdown%2C)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20SARONCal%2C%0A%20%20%20%20SARON_BD%2C%0A%20%20%20%20dropdown%2C%0A%20%20%20%20int_period%2C%0A%20%20%20%20mcal%2C%0A%20%20%20%20pd%2C%0A%20%20%20%20saron_data%2C%0A%20%20%20%20sofr_data%2C%0A)%3A%0A%20%20%20%20if%20dropdown.value%20%3D%3D%20'SOFR'%3A%0A%20%20%20%20%20%20%20%20mycal%20%3D%20mcal.get_calendar('SIFMAUS')%0A%20%20%20%20%20%20%20%20business_days%20%3D%20mcal.date_range(mycal.schedule(start_date%3Dint_period.value%5B'start'%5D%2C%20end_date%3Dint_period.value%5B'end'%5D)%2Cfrequency%3D'1D').tz_convert(None)%0A%20%20%20%20%20%20%20%20business_days%20%3D%20business_days.normalize()%0A%20%20%20%20%20%20%20%20hols%20%3D%20mycal.holidays().holidays%0A%20%20%20%20%20%20%20%20ext_data%20%3D%20sofr_data%0A%0A%20%20%20%20elif%20dropdown.value%20%3D%3D%20'SARON'%3A%0A%20%20%20%20%20%20%20%20business_days%20%3D%20pd.date_range(int_period.value%5B'start'%5D%2C%20end%3Dint_period.value%5B'end'%5D%2C%20freq%3DSARON_BD)%0A%20%20%20%20%20%20%20%20hols%20%3D%20SARONCal().holidays(int_period.value%5B'start'%5D%2Cend%3Dint_period.value%5B'end'%5D)%0A%20%20%20%20%20%20%20%20ext_data%20%3D%20saron_data%0A%20%20%20%20return%20business_days%2C%20ext_data%2C%20hols%2C%20mycal%0A%0A%0A%40app.cell%0Adef%20_(CustomBusinessDay%2C%20hol)%3A%0A%20%20%20%20class%20SARONCal(hol.AbstractHolidayCalendar)%3A%0A%20%20%20%20%20%20%20rules%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20hol.Holiday('New%20Year'%2C%20month%3D1%2C%20day%3D1)%2C%0A%20%20%20%20%20%20%20%20%20hol.Holiday('Berchtoldstag'%2C%20month%3D1%2C%20day%3D2)%2C%0A%20%20%20%20%20%20%20%20%20hol.Holiday('Good%20Friday'%2C%20month%3D1%2C%20day%3D1%2C%20offset%3D%5Bhol.Easter()%2C%20hol.Day(-2)%5D)%2C%0A%20%20%20%20%20%20%20%20%20hol.Holiday('Easter%20Monday'%2C%20month%3D1%2C%20day%3D1%2C%20offset%3D%5Bhol.Easter()%2C%20hol.Day(1)%5D)%2C%20%20%0A%20%20%20%20%20%20%20%20%20hol.Holiday('Labor%20Day'%2C%20month%3D5%2C%20day%3D1)%2C%0A%20%20%20%20%20%20%20%20%20hol.Holiday('Ascension%20Day'%2C%20month%3D1%2C%20day%3D1%2C%20offset%3D%5Bhol.Easter()%2C%20hol.Day(39)%5D)%2C%0A%20%20%20%20%20%20%20%20%20hol.Holiday('Whitmonday'%2C%20month%3D1%2C%20day%3D1%2C%20offset%3D%5Bhol.Easter()%2C%20hol.Day(50)%5D)%2C%0A%20%20%20%20%20%20%20%20%20hol.Holiday('National%20Day'%2C%20month%3D8%2C%20day%3D1)%2C%0A%20%20%20%20%20%20%20%20%20hol.Holiday('Christmas'%2C%20month%3D12%2C%20day%3D25)%2C%0A%20%20%20%20%20%20%20%20%20hol.Holiday('St.%20Stephens%20Day'%2C%20month%3D12%2C%20day%3D26)%20%20%0A%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20SARON_BD%20%3D%20CustomBusinessDay(calendar%3DSARONCal())%0A%20%20%20%20return%20SARONCal%2C%20SARON_BD%0A%0A%0A%40app.cell%0Adef%20_(ext_data%2C%20mo)%3A%0A%20%20%20%20_df%20%3D%20ext_data.iloc%5B%5B0%2C%20-1%5D%5D%0A%20%20%20%20_df%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20f%22%22%22%0A%20%20%20%20%20%20Last%20Fixing%20on%20%7Bext_data%5B'index'%5D.dt.date.iloc%5B-1%5D%7D%3A%20%7Bext_data%5B'RATE'%5D.iloc%5B-1%5D%7D%25%0A%20%20%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20int_period%20%3D%20mo.md(%22%7Bstart%7D%20%E2%86%92%20%7Bend%7D%22).batch(%0A%20%20%20%20%20%20%20%20start%3Dmo.ui.date(label%3D%22Start%20Date%22)%2C%0A%20%20%20%20%20%20%20%20end%3Dmo.ui.date(label%3D%22End%20Date%22)%0A%20%20%20%20)%0A%20%20%20%20int_period%0A%20%20%20%20return%20(int_period%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20inp_nom%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%20start%20%3D%200%2C%20stop%3D10000%2C%20step%3D1%2C%20value%3D100%2C%0A%20%20%20%20%20%20%20%20label%20%3D%20'nominal%20(millions)%3A'%0A%20%20%20%20)%0A%0A%20%20%20%20inp_cas%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%20start%20%3D%200%2C%20stop%3D100%2C%20step%3D0.001%2C%20value%20%3D%200%2C%0A%20%20%20%20%20%20%20%20label%20%3D%20'cas%20(bps)%3A'%0A%20%20%20%20)%0A%0A%20%20%20%20inp_margin%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%20start%20%3D%20-250%2C%20stop%3D1000%2C%20step%3D0.001%2C%20value%20%3D%20100%2C%0A%20%20%20%20%20%20%20%20label%20%3D%20'margin%20(bps)%3A'%0A%20%20%20%20)%0A%0A%20%20%20%20inp_lookback%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%20start%20%3D%200%2C%20stop%3D20%2C%20step%3D1%2C%20value%20%3D%205%2C%0A%20%20%20%20%20%20%20%20label%20%3D%20'lookback%20(days)%3A'%0A%20%20%20%20)%0A%0A%20%20%20%20inp_rounding%20%3D%20mo.ui.number(%0A%20%20%20%20%20%20%20%20start%20%3D%200%2C%20stop%3D10%2C%20step%3D1%2C%20value%20%3D%206%2C%0A%20%20%20%20%20%20%20%20label%20%3D%20'rounding%20(digits)%3A'%2C%0A%20%20%20%20)%0A%0A%20%20%20%20params%20%3D%20%5Binp_nom%2C%20inp_cas%2C%20inp_margin%2C%20inp_lookback%2C%20inp_rounding%5D%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20params%2C%0A%20%20%20%20%20%20%20%20align%20%3D%20'start'%2C%0A%20%20%20%20%20%20%20%20justify%3D'center'%2C%0A%20%20%20%20%20%20%20%20gap%3D0.5%0A%20%20%20%20)%0A%20%20%20%20return%20inp_cas%2C%20inp_lookback%2C%20inp_margin%2C%20inp_nom%2C%20inp_rounding%2C%20params%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20base_rate_accr%2C%0A%20%20%20%20df%2C%0A%20%20%20%20inp_nom%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20spread_accr%2C%0A%20%20%20%20total_accr%2C%0A%20%20%20%20total_accr_round%2C%0A)%3A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.stat(value%3D'%7B%3A%2C.6f%7D'.format(base_rate_accr%2Finp_nom.value%2F10000%2Fdf%5B'DCF'%5D.sum())%2C%20label%3D%22base%20rate%22%2Cdirection%3D%22decrease%22%2C%20bordered%3DTrue)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.stat(value%3D'%7B%3A%2C.6f%7D'.format(total_accr%2Finp_nom.value%2F10000%2Fdf%5B'DCF'%5D.sum())%2C%20label%3D%22all-in%20rate%22%2Cdirection%3D%22decrease%22%2C%20bordered%3DTrue)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.stat(value%3D'%7B%3A%2C.6f%7D'.format(total_accr_round%2Finp_nom.value%2F10000%2Fdf%5B'DCF'%5D.sum())%2C%20label%3D%22rounded%20all-in%20rate%22%2Cdirection%3D%22decrease%22%2C%20bordered%3DTrue)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.stat(value%3D'%7B%3A%2C.0f%7D'.format(df%5B'DCF'%5D.sum()*360)%2C%20label%3D%22day%20count%22%2Cdirection%3D%22decrease%22%2C%20bordered%3DTrue)%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2Calign%3D'start'%2Cjustify%3D'start')%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22-----------------------------%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.stat(value%3D'%7B%3A%2C.2f%7D'.format(base_rate_accr)%2C%20label%3D%22base%20rate%20accrual%22%2C%20direction%3D%22increase%22%2C%20bordered%3DTrue)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.stat(value%3D'%7B%3A%2C.2f%7D'.format(spread_accr)%2C%20label%3D%22spread%20accrual%22%2Cdirection%3D%22decrease%22%2C%20bordered%3DTrue)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.stat(value%3D'%7B%3A%2C.2f%7D'.format(total_accr)%2C%20label%3D%22total%20accrual%22%2Cdirection%3D%22decrease%22%2C%20bordered%3DTrue)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.stat(value%3D'%7B%3A%2C.2f%7D'.format(total_accr_round)%2C%20label%3D%22total%20accrual%20rounded%20rate%22%2Cdirection%3D%22decrease%22%2C%20bordered%3DTrue)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%2Calign%3D'start'%2Cjustify%3D'start')%0A%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20align%3D%22stretch%22%2C%0A%20%20%20%20%20%20%20%20gap%3D1%2C%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20business_days%2C%0A%20%20%20%20ext_data%2C%0A%20%20%20%20hols%2C%0A%20%20%20%20inp_cas%2C%0A%20%20%20%20inp_lookback%2C%0A%20%20%20%20inp_margin%2C%0A%20%20%20%20inp_nom%2C%0A%20%20%20%20inp_rounding%2C%0A%20%20%20%20pd%2C%0A)%3A%0A%20%20%20%20%23here%20the%20magic%20happens%0A%0A%20%20%20%20df%20%3D%20pd.Series(business_days%2Cname%20%3D'DATE').to_frame('DATE')%0A%0A%20%20%20%20%23rebasing%20to%20keep%20code%20cleaner%0A%20%20%20%20nominal%20%3D%20inp_nom.value%20*%201e6%0A%20%20%20%20cas%20%3D%20inp_cas.value%20%2F10000%0A%20%20%20%20margin%20%3D%20inp_margin.value%20%2F10000%0A%0A%0A%20%20%20%20df%5B'FIXING_DATE'%5D%20%3Ddf%5B'DATE'%5D%20%2B%20pd.offsets.CustomBusinessDay(n%3D-inp_lookback.value%2C%20holidays%3Dhols)%0A%20%20%20%20dcf%20%3D%20(business_days.diff().days%2F360)%0A%20%20%20%20df%5B'DCF'%5D%20%3D%20dcf%0A%20%20%20%20df%5B'DCF'%5D%20%3D%20df%5B'DCF'%5D.shift(-1)%0A%20%20%20%20df%20%3D%20pd.merge(df%2C%20ext_data%2C%20left_on%3D'FIXING_DATE'%2C%20right_on%3D'index')%0A%20%20%20%20df%5B'RATE'%5D%20%3D%20df%5B'RATE'%5D%20%2F100%0A%20%20%20%20df%5B'IR_FACTOR'%5D%3D%201%20%2B%20df%5B'DCF'%5D%20*%20df%5B'RATE'%5D%0A%20%20%20%20%23df%5B'IR_FACTOR'%5D%3D(df%5B'IR_FACTOR'%5D).round(9)%0A%20%20%20%20df%5B'UCCDR_i'%5D%3D%20df%5B'IR_FACTOR'%5D.cumprod()%20-%201%0A%20%20%20%20df%5B'DAILY_CMP_RATE'%5D%20%3D%20df%5B'UCCDR_i'%5D.diff()%20*%201%20%2F%20df%5B'DCF'%5D%0A%20%20%20%20df%5B'DAILY_CMP_RATE_RND'%5D%20%3D%20(df%5B'DAILY_CMP_RATE'%5D).round(inp_rounding.value)%0A%20%20%20%20df.at%5B0%2C%20'DAILY_CMP_RATE'%5D%20%3D%20df.at%5B0%2C%20'RATE'%5D%0A%20%20%20%20df%5B'BASERATE_ACCR'%5D%20%3D%20(nominal%20*%20df%5B'DAILY_CMP_RATE'%5D.round(inp_rounding.value)%20*%20df%5B'DCF'%5D).round(2)%0A%20%20%20%20%23df%5B'BASERATE_ACCR'%5D%20%3D%20(nominal%20*%20df%5B'DAILY_CMP_RATE'%5D%20*%20df%5B'DCF'%5D).round(2)%0A%20%20%20%20df%5B'MARGIN%20(bps)'%5D%20%3D%20inp_margin.value%0A%20%20%20%20df%5B'CAS%20(bps)'%5D%20%3D%20inp_cas.value%0A%20%20%20%20df%5B'SPREAD_ACCR'%5D%20%3D%20(nominal%20*%20(cas%20%2B%20margin)%20*%20df%5B'DCF'%5D).round(2)%0A%20%20%20%20df%5B'TOTAL_ACCR'%5D%20%3D%20((margin%2Bcas%2Bdf%5B'DAILY_CMP_RATE'%5D).round(inp_rounding.value)%20*%20df%5B'DCF'%5D%20*%20nominal).round(2)%0A%20%20%20%20%23df%5B'TOTAL_ACCR'%5D%20%3Ddf%5B'BASERATE_ACCR'%5D%20%2B%20df%5B'SPREAD_ACCR'%5D%0A%20%20%20%20df%5B'ACCRUED'%5D%20%3D%20df%5B'TOTAL_ACCR'%5D.cumsum().round(2)%0A%20%20%20%20df%20%3D%20df.sort_values(by%3D%5B'DATE'%5D%2Cascending%3DTrue)%0A%20%20%20%20base_rate_accr%20%3D%20df%5B'BASERATE_ACCR'%5D.sum().round(2)%0A%20%20%20%20spread_accr%20%3D%20df%5B'SPREAD_ACCR'%5D.sum().round(2)%0A%20%20%20%20total_accr%20%3D%20df%5B'TOTAL_ACCR'%5D.sum().round(2)%0A%20%20%20%20total_accr_round%20%3D%20((total_accr%20%2F%20nominal%20%2F%20df%5B'DCF'%5D.sum()).round(inp_rounding.value)%20*%20df%5B'DCF'%5D.sum()%20*%20nominal).round(2)%0A%20%20%20%20%23total_accr%20%3D%20base_rate_accr%20%2B%20spread_accr%0A%20%20%20%20%23df.style.format(%7B'DCF'%3A%20lambda%20val%3A%20f'%7Bval%3A%2C.4f%7D'%2C%7D)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20base_rate_accr%2C%0A%20%20%20%20%20%20%20%20cas%2C%0A%20%20%20%20%20%20%20%20dcf%2C%0A%20%20%20%20%20%20%20%20df%2C%0A%20%20%20%20%20%20%20%20margin%2C%0A%20%20%20%20%20%20%20%20nominal%2C%0A%20%20%20%20%20%20%20%20spread_accr%2C%0A%20%20%20%20%20%20%20%20total_accr%2C%0A%20%20%20%20%20%20%20%20total_accr_round%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20mo)%3A%0A%20%20%20%20table%20%3D%20mo.ui.table(%0A%20%20%20%20%20%20%20%20data%3Ddf%2C%0A%20%20%20%20%20%20%20%20%23%20use%20pagination%20when%20your%20table%20has%20many%20rows%0A%20%20%20%20%20%20%20%20pagination%3DFalse%2C%0A%20%20%20%20%20%20%20%20show_column_summaries%3DFalse%2C%0A%20%20%20%20%20%20%20%20label%3D%22Dataframe%22%2C%0A%20%20%20%20)%0A%20%20%20%20table%0A%20%20%20%20return%20(table%2C)%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20df)%3A%0A%20%20%20%20_df%20%3D%20df%5B%5B'DATE'%2C'RATE'%2C'DAILY_CMP_RATE'%2C'MARGIN%20(bps)'%2C'CAS%20(bps)'%2C'ACCRUED'%5D%5D%0A%20%20%20%20_df%5B'ALL-IN'%5D%20%3D%20_df%5B'DAILY_CMP_RATE'%5D%20%2B%20_df%5B'MARGIN%20(bps)'%5D%2F10000%20%2B%20_df%5B'CAS%20(bps)'%5D%2F10000%0A%20%20%20%20_valstr%3D'%25'%0A%20%20%20%20_varstr%3D'Rate'%0A%20%20%20%20%23_df%20%3D%20_df.melt(id_vars%3D%5B'DATE'%5D%2C%20value_vars%20%3D%20%5B'RATE'%2C'DAILY_CMP_RATE'%2C'ALL-IN'%2C'ACCRUED'%5D%2C%20var_name%20%3D%20%23_varstr%2C%20value_name%3D_valstr)%0A%20%20%20%20%23_df%5B_valstr%5D%20%3D%20_df%5B_valstr%5D*100%0A%0A%20%20%20%20_base%20%3D%20alt.Chart(_df).encode(%0A%20%20%20%20%20%20%20%20alt.X('DATE')%0A%20%20%20%20)%0A%0A%20%20%20%20_line%20%3D%20_base.mark_line(color%3D'red').encode(%0A%20%20%20%20%20%20%20%20alt.Y('RATE')%0A%20%20%20%20)%0A%0A%20%20%20%20_bar%20%3D%20_base.mark_bar().encode(%0A%20%20%20%20%20%20%20%20alt.Y('ACCRUED')%0A%20%20%20%20)%0A%0A%20%20%20%20alt.layer(_line%2C%20_bar).resolve_scale(%0A%20%20%20%20%20%20%20%20y%3D'independent'%0A%20%20%20%20)%0A%0A%20%20%20%20%23_base%0A%0A%20%20%20%20%23chart1%20%3D%20mo.ui.altair_chart(_base)%0A%20%20%20%20%23_df%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
  </body>
</html>
